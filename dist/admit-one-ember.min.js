!function(){var t,e,n,i;!function(){function r(t,e,i){for(var r,o,s=t.length,u=new Array(s),c=0,h=s;h>c;c++)r=t[c],"exports"===r?o=u[c]=i:u[c]=n(a(r,e));return{deps:u,exports:o}}function a(t,e){if("."!==t.charAt(0))return t;var n,i=t.split("/"),r=e.split("/");n=1===r.length?r:r.slice(0,-1);for(var a=0,o=i.length;o>a;a++){var s=i[a];if(".."===s)n.pop();else{if("."===s)continue;n.push(s)}}return n.join("/")}var o={},s={},u={},c=!1;t=function(t,e,n){o[t]={deps:e,callback:n}},i=n=e=function(t){if(u[t]!==c&&s.hasOwnProperty(t))return s[t];if(!o[t])throw new Error("Could not find module "+t);var e,n,i=o[t],a=!1;s[t]={};try{e=r(i.deps,t,s[t]),n=i.callback.apply(this,e.deps),a=!0}finally{a||(u[t]=c)}return e.exports?s[t]:s[t]=n},i.entries=i._eak_seen=o,i.clear=function(){i.entries=i._eak_seen=o={},s=u={}}}(),t("ember-admit-one",["ember-tiny-auth","ember-admit-one/authenticator","ember-admit-one/authorizer","ember-admit-one/setup","exports"],function(t,e,n,i,r){"use strict";var a=t["default"],o=e["default"],s=n["default"],u=i["default"],c={};Ember.$.extend(c,a),c.Authenticator=o,c.Authorizer=s,c.setup=u,r["default"]=c}),t("ember-admit-one/authenticator",["ember-tiny-auth","ember-admit-one/xhr","exports"],function(t,e,n){"use strict";var i=t["default"],r=e.extractAuthorizationHeader,a=i.Authenticator.Base.extend({authenticate:function(t){var e=this.container.lookup("admit-one-settings:main"),n=e.api.authenticate;return new Ember.RSVP.Promise(function(e,i){Ember.$.ajax(n,{method:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify({session:t})}).then(function(t,n,i){var a=r(i),o=a[0];e(Ember.$.extend({},t.session,{token:o}))},function(t,e,n){var r=n;t.responseJSON&&(r=t.responseJSON),r.error&&(r=r.error),i(r,n)})})},invalidate:function(){var t=this.container.lookup("admit-one-settings:main"),e=t.api.invalidate;return new Ember.RSVP.Promise(function(t,n){Ember.$.ajax(e,{method:"delete",contentType:"application/json; charset=utf-8"}).then(function(){t()},function(t,e,i){n(i)})})}});n["default"]=a}),t("ember-admit-one/authorizer",["ember-tiny-auth","ember-admit-one/xhr","exports"],function(t,e,n){"use strict";var i=t["default"],r=e.extractAuthorizationHeader,a=i.Authorizer.Base.extend(Ember.Evented,{authorize:function(t,e){var n=this.get("session"),i=n.get("token");i&&(e.beforeSend=function(t){return function(e){return e.setRequestHeader("Authorization","Token "+i),t.apply(this,arguments)}}(e.beforeSend||function(){})),e.success=e.success||[],e.success=Ember.$.isArray(e.success)?e.success:[e.success],e.success.unshift(function(t,e,i){var a=r(i),o=a[0],s=a[1];s?n.invalidate():o&&(this.trigger("authorization-token",o),this.set("capturedAuthorization",{token:o}),n.integrateContent({token:o}))}.bind(this))}});n["default"]=a}),t("ember-admit-one/setup",["exports"],function(t){"use strict";var e=function(t){var e=t||{};e.containers=Ember.$.extend(e.containers||{},{authenticator:"auth-session-authenticator:admit-one",authorizer:"auth-session-authorizer:admit-one",storage:"auth-session-storage:local"}),"string"===Ember.typeOf(e.api)&&(e.api={endpoint:e.api}),e.api=e.api||{},e.api.endpoint=e.api.endpoint||"/api",e.api.authenticate=e.api.authenticate||e.api.endpoint+"/sessions",e.api.invalidate=e.api.invalidate||e.api.endpoint+"/sessions/current",Ember.Application.initializer({name:"admit-one",initialize:function(t,n){var i=Ember.AdmitOne,r=i.Authenticator,a=i.Authorizer;n.register("auth-session-authenticator:admit-one",r),n.register("auth-session-authorizer:admit-one",a),n.register("admit-one-settings:main",e,{instantiate:!1}),Ember.TinyAuth.setup(t,n,e.containers)}})};t["default"]=e}),t("ember-admit-one/xhr",["exports"],function(t){"use strict";var e=function(t){var e=t.getResponseHeader("Authorization"),n=e&&e.match(/\s*token\s+(.*)\s*/i),i=n&&n[1],r=e&&!!e.match(/\s*invalidated\s*/i);return[i,r]};t.extractAuthorizationHeader=e}),t("ember-tiny-auth",["exports"],function(t){"use strict";var e={},n={},i={};e.Base=Ember.Object.extend(Ember.Evented,{persist:function(){throw new Error("implement persist")},restore:function(){throw new Error("implement restore")},clear:function(){throw new Error("implement clear")}}),e.Local=e.Base.extend({init:function(){this._super(),this._watchStorage()},persist:function(t){localStorage.setItem("auth-data",JSON.stringify(t))},restore:function(){return JSON.parse(localStorage.getItem("auth-data"))},clear:function(){localStorage.removeItem("auth-data")},_watchStorage:function(){Ember.$(window).on("storage",function(){this.trigger("change")}.bind(this))}}),n.Base=Ember.Object.extend({authenticate:function(){return Ember.RSVP.reject("implement authenticate")},invalidate:function(){return Ember.RSVP.resolve()}}),i.Base=Ember.Object.extend({session:function(){return this.container.lookup("auth-session:main")}.property(),authorize:function(){},capturedAuthorization:void 0});var r=Ember.ObjectProxy.extend({attemptedTransition:null,content:{},init:function(){this._super(),this._installPrefilter()},storage:function(){var t=this.container.lookup("auth-session-settings:main");return this.container.lookup(t.storage)}.property(),authenticator:function(){var t=this.container.lookup("auth-session-settings:main");return this.container.lookup(t.authenticator)}.property(),authorizer:function(){var t=this.container.lookup("auth-session-settings:main");return this.container.lookup(t.authorizer)}.property(),isAuthenticated:function(){return Ember.keys(this.get("content")).length>0}.property("content"),authenticate:function(t){return this.get("authenticator").authenticate(t).then(function(t){return this.set("content",t),t}.bind(this))},login:function(t){var e=this.get("authorizer"),n=e.get("capturedAuthorization");if(!n)throw new Error("Authorization information not captured by authorizer.");this.set("content",Ember.$.extend({},t,n))},invalidate:function(){if(this._invalidate)return this._invalidate;var t=function(){this.set("content",{}),this.get("authenticator").set("capturedAuthorization",void 0),this.get("storage").clear(),this._invalidate=void 0}.bind(this);return this._invalidate=this.get("authenticator").invalidate(this.get("content")).then(t,function(e){throw t(),e})},integrateContent:function(t){this.get("isAuthenticated")&&this.set("content",Ember.$.extend({},t,this.get("content")))},restore:function(){var t=this.get("storage"),e=t.restore()||{};this.set("content",e)},observeStorage:function(){var t=this.get("storage");t.off("change",this,this.restore),t.on("change",this,this.restore)},_contentChanged:function(){this.get("storage").persist(this.get("content"))}.observes("content"),_installPrefilter:function(){Ember.$.ajaxPrefilter(function(t,e,n){this.isDestroyed||t.crossDomain||this.get("authorizer").authorize(n,t)}.bind(this))}}),a=Ember.Mixin.create({beforeModel:function(t){this._super(),this.get("session").get("isAuthenticated")||(this.get("session").set("attemptedTransition",t),this.transitionTo("login"))}}),o=function(t,a,o){var s=Ember.$.extend({},{authenticator:"auth-session-authenticator:base",authorizer:"auth-session-authorizer:base",storage:"auth-session-storage:local"},o);a.register("auth-session-settings:main",s,{instantiate:!1}),a.register("auth-session:main",r),a.register("auth-session-authenticator:base",n),a.register("auth-session-authorizer:base",i),a.register("auth-session-storage:local",e.Local),a.inject("controller","session","auth-session:main"),a.inject("route","session","auth-session:main");var u=t.lookup("auth-session:main");u.restore(),u.observeStorage()};Ember.TinyAuth={setup:o,Storage:e,Authenticator:n,Authorizer:i,AuthenticatedRouteMixin:a},t["default"]=Ember.TinyAuth}),Ember.AdmitOne=n("ember-admit-one").default}();